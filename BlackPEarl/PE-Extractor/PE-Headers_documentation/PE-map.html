<!-- I am not good at coloring it my i haven't unlocked this skill yet :) -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PE File Structure on Hard Disk</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background-image: url('44145ccaa909c88cda4b04aca54e0617.jpg');
            background-repeat: repeat;
            background-attachment: fixed;
            background-position: center;
            margin: 0px 50px 0px 50px;
            padding: 20px;
            min-height: 100vh;
            }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            border-radius: 15px;
            padding: 50px;
            background-color: #1615153b !important;
            backdrop-filter: blur(2px);
            border: 2px solid black;
        }
        h1{
            text-align: center;
            color: #fcfafac2;
            font-size: 2.5em;
            margin-bottom: 30px;
        }
        
        .pe-structure {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .header-section {
            border: 1px solid black;
            border-radius: 10px;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .header-section:hover {
            transform: translateY(-5px);
        }
        
        .header-title {
            background: #fcfafa98;
            color: #000;
            padding: 15px;
            font-weight: bold;
            font-size: 1.2em;
            text-align: center;
        }
        
        .header-content {
            padding: 20px;
        }
        
        .field-row {
            display: grid;
            grid-template-columns: 80px 200px 120px 1fr;
            gap: 15px;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            align-items: center;
        }
        
        .field-row:last-child {
            border-bottom: none;
        }
        
        .offset {
            color: #f729c3f7;
            font-weight: bold;
            background: #fcfafa33;
            padding: 5px;
            border-radius: 5px;
            text-align: center;
        }
        
        .field-name {
            color: #fcfafa98;
            font-weight: bold;
        }
        ::selection {
            background-color: #333333;
        }
        .data-type {
            color: #3ab49f;
            font-weight: bold;
            padding: 3px 8px;
            padding-left: 80px;
            border-radius: 15px;
            text-align: center;
            font-size: 0.9em;
        }
        
        .description {
            padding-left: 80px;
            color: rgba(6, 144, 195, 0.866);
            font-weight: bold;
            font-size: 0.9em;
        }
        
        .section-header {
            background: #fcfafa98;
            color: black;
            padding: 10px;
            font-weight: bold;
            text-align: center;
            margin-top: 10px;
            border-radius: 5px;
        }
        
        .memory-layout {

            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .byte-visualization {
            display: grid;
            grid-template-columns: repeat(16, 1fr);
            gap: 2px;
            margin: 10px 0;
        }
        
        .byte {
            width: 25px;
            height: 25px;
            background: #333;
            border: 1px solid #555;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7em;
            color: #ccc;
        }
        
        .byte.dos-header { background: #ff6b6b; color: white; }
        .byte.pe-header { background: #00ff88; color: black; }
        .byte.optional-header { background: #74c0fc; color: black; }
        .byte.section-table { background: #ffd43b; color: black; }
        
        .legend {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 3px;
        }
        
        .tooltip {
            position: fixed;
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.95), rgba(30, 30, 46, 0.95));
            border: 2px solid #00ff88;
            border-radius: 10px;
            padding: 20px;
            max-width: 400px;
            z-index: 1000;
            color: #ffffff;
            font-family: 'Courier New', monospace;
            box-shadow: 0 10px 30px rgba(0, 255, 136, 0.3);
            backdrop-filter: blur(10px);
            pointer-events: none;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.3s ease;
        }
        
        .tooltip.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        .tooltip-title {
            color: #00ff88;
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 10px;
            border-bottom: 1px solid rgba(0, 255, 136, 0.3);
            padding-bottom: 5px;
        }
        
        .tooltip-content {
            line-height: 1.4;
        }
        
        .tooltip-example {
            background: rgba(255, 212, 59, 0.1);
            border-left: 3px solid #ffd43b;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
        }
        
        .tooltip-example-title {
            color: #ffd43b;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .field-name {
            color: #ffffff93;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .field-name:hover {
            color:#ffffff;
        }
        
        .pe-overview {
            border: 1px solid #ffffff91;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            backdrop-filter: blur(5px);
        }
        
        .pe-overview h2 {
            color:#ffffff93;            
            text-align: center;
            margin-bottom: 25px;
            font-size: 1.8em;
        }
        
        .layout-diagram {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }
        
        .layout-section {
            width: 100%;
            max-width: 600px;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid #ffffff93;
            transition: all 0.3s ease;
        }
        
        .layout-section:hover {
            transform: scale(1.02);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
        }
        
        .dos-section {
            border-color: #ffffff93;
        }
        
        .pe-section {
            border-color: #ffffff93;
        }
        
        .optional-section {
            border-color: #ffffff93;
        }
        
        .section-section {
            border-color: #ffffff93;
        }
        
        .data-section {
            border-color: #ffffff93;
        }
        
        .section-label {
            
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 5px;
        }
        
        .section-size {
            color: #ffd43b;
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .section-desc {
            font-size: 0.9em;
            color: #c9c9c9;
            line-height: 1.3;
        }
        
        .layout-arrow {
            font-size: 1.5em;
            color: #fcfafac8;
            font-weight: bold;
        }
        
        .footer {
            
            border-top: 1px solid #ffffff;
            border-right: 1px solid #ffffff;
            border-left: 1px solid #ffffff;
            padding: 30px;
            margin-top: 50px;
            text-align: center;
            border-radius: 15px 15px 0 0;
            backdrop-filter: blur(1px);
        }
        
        .footer h3 {
            color: #ffffff93;
            margin-bottom: 15px;
            font-size: 1.5em;
            text-shadow: 0 0 10px rgba(0, 255, 136, 0.3);
        }
        
        .footer p {
            color: #c9c9c9;
            margin: 10px 0;
            line-height: 1.5;
        }
        
        .footer .author {
            color: #74c0fc;
            font-weight: bold;
            font-size: 1.1em;
            margin-top: 20px;
        }
        
        .footer .tech-stack {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .tech-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 15px;
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>PE File Structure on Hard Disk</h1>
        
        <!-- PE File Layout Overview -->
        <div class="pe-overview">
            <h2>PE File Layout Overview</h2>
            <div class="layout-diagram">
                <div class="layout-section dos-section">
                    <div class="section-label">DOS Header</div>
                    <div class="section-size">64 bytes</div>
                    <div class="section-desc">Legacy DOS compatibility header with "MZ" signature</div>
                </div>
                <div class="layout-arrow">↓</div>
                <div class="layout-section dos-section">
                    <div class="section-label">DOS Stub</div>
                    <div class="section-size">Variable</div>
                    <div class="section-desc">Small DOS program that prints "This program cannot be run in DOS mode"</div>
                </div>
                <div class="layout-arrow">↓</div>
                <div class="layout-section pe-section">
                    <div class="section-label">PE Signature</div>
                    <div class="section-size">4 bytes</div>
                    <div class="section-desc">"PE\0\0" signature at offset specified by e_lfanew</div>
                </div>
                <div class="layout-arrow">↓</div>
                <div class="layout-section pe-section">
                    <div class="section-label">File Header</div>
                    <div class="section-size">20 bytes</div>
                    <div class="section-desc">COFF header with machine type, section count, and characteristics</div>
                </div>
                <div class="layout-arrow">↓</div>
                <div class="layout-section optional-section">
                    <div class="section-label">Optional Header</div>
                    <div class="section-size">224/240 bytes</div>
                    <div class="section-desc">Entry point, image base, section alignment, and data directories</div>
                </div>
                <div class="layout-arrow">↓</div>
                <div class="layout-section section-section">
                    <div class="section-label">Section Table</div>
                    <div class="section-size">40 bytes × N</div>
                    <div class="section-desc">Array of section headers describing .text, .data, .rsrc, etc.</div>
                </div>
                <div class="layout-arrow">↓</div>
                <div class="layout-section data-section">
                    <div class="section-label">Section Data</div>
                    <div class="section-size">Variable</div>
                    <div class="section-desc">Actual executable code, initialized data, resources, etc.</div>
                </div>
            </div>
        </div>
        
        <div class="legend">
            <div class="legend-item">
                <div class="legend-color" style="background: #ff6b6b;"></div>
                <span>DOS Header</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #00ff88;"></div>
                <span>PE Header</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #74c0fc;"></div>
                <span>Optional Header</span>
            </div>
            <div class="legend-item">
                <div class="legend-color" style="background: #ffd43b;"></div>
                <span>Section Table</span>
            </div>
        </div>
        
        <div class="pe-structure">
            <!-- DOS Header -->
            <div class="header-section">
                <div class="header-title">DOS Header (IMAGE_DOS_HEADER) - 64 bytes</div>
                <div class="header-content">
                    <div class="field-row">
                        <div class="offset">0x00</div>
                        <div class="field-name">e_magic</div>
                        <div class="data-type">WORD</div>
                        <div class="description">Magic number (4D5A = "MZ")</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">0x02</div>
                        <div class="field-name">e_cblp</div>
                        <div class="data-type">WORD</div>
                        <div class="description">Bytes on last page of file</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">0x04</div>
                        <div class="field-name">e_cp</div>
                        <div class="data-type">WORD</div>
                        <div class="description">Pages in file</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">0x06</div>
                        <div class="field-name">e_crlc</div>
                        <div class="data-type">WORD</div>
                        <div class="description">Relocations</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">0x08</div>
                        <div class="field-name">e_cparhdr</div>
                        <div class="data-type">WORD</div>
                        <div class="description">Size of header in paragraphs</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">0x0A</div>
                        <div class="field-name">e_minalloc</div>
                        <div class="data-type">WORD</div>
                        <div class="description">Minimum extra paragraphs needed</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">0x0C</div>
                        <div class="field-name">e_maxalloc</div>
                        <div class="data-type">WORD</div>
                        <div class="description">Maximum extra paragraphs needed</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">0x0E</div>
                        <div class="field-name">e_ss</div>
                        <div class="data-type">WORD</div>
                        <div class="description">Initial relative SS value</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">0x10</div>
                        <div class="field-name">e_sp</div>
                        <div class="data-type">WORD</div>
                        <div class="description">Initial SP value</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">0x12</div>
                        <div class="field-name">e_csum</div>
                        <div class="data-type">WORD</div>
                        <div class="description">Checksum</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">0x14</div>
                        <div class="field-name">e_ip</div>
                        <div class="data-type">WORD</div>
                        <div class="description">Initial IP value</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">0x16</div>
                        <div class="field-name">e_cs</div>
                        <div class="data-type">WORD</div>
                        <div class="description">Initial relative CS value</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">0x18</div>
                        <div class="field-name">e_lfarlc</div>
                        <div class="data-type">WORD</div>
                        <div class="description">File address of relocation table</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">0x1A</div>
                        <div class="field-name">e_ovno</div>
                        <div class="data-type">WORD</div>
                        <div class="description">Overlay number</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">0x1C</div>
                        <div class="field-name">e_res[4]</div>
                        <div class="data-type">WORD[4]</div>
                        <div class="description">Reserved words</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">0x24</div>
                        <div class="field-name">e_oemid</div>
                        <div class="data-type">WORD</div>
                        <div class="description">OEM identifier</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">0x26</div>
                        <div class="field-name">e_oeminfo</div>
                        <div class="data-type">WORD</div>
                        <div class="description">OEM information</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">0x28</div>
                        <div class="field-name">e_res2[10]</div>
                        <div class="data-type">WORD[10]</div>
                        <div class="description">Reserved words</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">0x3C</div>
                        <div class="field-name">e_lfanew</div>
                        <div class="data-type">LONG</div>
                        <div class="description">File address of new exe header</div>
                    </div>
                </div>
            </div>

            <!-- PE Header -->
            <div class="header-section">
                <div class="header-title">PE Header (IMAGE_NT_HEADERS) - Variable Size</div>
                <div class="header-content">
                    <div class="section-header">PE Signature - 4 bytes</div>
                    <div class="field-row">
                        <div class="offset">e_lfanew</div>
                        <div class="field-name">Signature</div>
                        <div class="data-type">DWORD</div>
                        <div class="description">PE signature (50450000 = "PE\0\0")</div>
                    </div>
                    
                    <div class="section-header">File Header (IMAGE_FILE_HEADER) - 20 bytes</div>
                    <div class="field-row">
                        <div class="offset">+0x04</div>
                        <div class="field-name">Machine</div>
                        <div class="data-type">WORD</div>
                        <div class="description">Machine type (x86, x64, etc.)</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x06</div>
                        <div class="field-name">NumberOfSections</div>
                        <div class="data-type">WORD</div>
                        <div class="description">Number of sections</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x08</div>
                        <div class="field-name">TimeDateStamp</div>
                        <div class="data-type">DWORD</div>
                        <div class="description">Time date stamp</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x0C</div>
                        <div class="field-name">PointerToSymbolTable</div>
                        <div class="data-type">DWORD</div>
                        <div class="description">File pointer to COFF symbol table</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x10</div>
                        <div class="field-name">NumberOfSymbols</div>
                        <div class="data-type">DWORD</div>
                        <div class="description">Number of symbols</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x14</div>
                        <div class="field-name">SizeOfOptionalHeader</div>
                        <div class="data-type">WORD</div>
                        <div class="description">Size of optional header</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x16</div>
                        <div class="field-name">Characteristics</div>
                        <div class="data-type">WORD</div>
                        <div class="description">Characteristics flags</div>
                    </div>
                </div>
            </div>

            <!-- Optional Header -->
            <div class="header-section">
                <div class="header-title">Optional Header (IMAGE_OPTIONAL_HEADER) - 224/240 bytes</div>
                <div class="header-content">
                    <div class="section-header">Standard Fields</div>
                    <div class="field-row">
                        <div class="offset">+0x18</div>
                        <div class="field-name">Magic</div>
                        <div class="data-type">WORD</div>
                        <div class="description">Magic number (10B=PE32, 20B=PE32+)</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x1A</div>
                        <div class="field-name">MajorLinkerVersion</div>
                        <div class="data-type">BYTE</div>
                        <div class="description">Linker major version</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x1B</div>
                        <div class="field-name">MinorLinkerVersion</div>
                        <div class="data-type">BYTE</div>
                        <div class="description">Linker minor version</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x1C</div>
                        <div class="field-name">SizeOfCode</div>
                        <div class="data-type">DWORD</div>
                        <div class="description">Size of code section</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x20</div>
                        <div class="field-name">SizeOfInitializedData</div>
                        <div class="data-type">DWORD</div>
                        <div class="description">Size of initialized data</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x24</div>
                        <div class="field-name">SizeOfUninitializedData</div>
                        <div class="data-type">DWORD</div>
                        <div class="description">Size of uninitialized data</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x28</div>
                        <div class="field-name">AddressOfEntryPoint</div>
                        <div class="data-type">DWORD</div>
                        <div class="description">Entry point RVA</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x2C</div>
                        <div class="field-name">BaseOfCode</div>
                        <div class="data-type">DWORD</div>
                        <div class="description">Base of code RVA</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x30</div>
                        <div class="field-name">BaseOfData</div>
                        <div class="data-type">DWORD</div>
                        <div class="description">Base of data RVA (PE32 only)</div>
                    </div>
                    
                    <div class="section-header">Windows-Specific Fields</div>
                    <div class="field-row">
                        <div class="offset">+0x34</div>
                        <div class="field-name">ImageBase</div>
                        <div class="data-type">ULONGLONG</div>
                        <div class="description">Preferred load address</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x3C</div>
                        <div class="field-name">SectionAlignment</div>
                        <div class="data-type">DWORD</div>
                        <div class="description">Section alignment in memory</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x40</div>
                        <div class="field-name">FileAlignment</div>
                        <div class="data-type">DWORD</div>
                        <div class="description">File alignment</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x44</div>
                        <div class="field-name">MajorOperatingSystemVersion</div>
                        <div class="data-type">WORD</div>
                        <div class="description">OS major version</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x46</div>
                        <div class="field-name">MinorOperatingSystemVersion</div>
                        <div class="data-type">WORD</div>
                        <div class="description">OS minor version</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x48</div>
                        <div class="field-name">MajorImageVersion</div>
                        <div class="data-type">WORD</div>
                        <div class="description">Image major version</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x4A</div>
                        <div class="field-name">MinorImageVersion</div>
                        <div class="data-type">WORD</div>
                        <div class="description">Image minor version</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x4C</div>
                        <div class="field-name">MajorSubsystemVersion</div>
                        <div class="data-type">WORD</div>
                        <div class="description">Subsystem major version</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x4E</div>
                        <div class="field-name">MinorSubsystemVersion</div>
                        <div class="data-type">WORD</div>
                        <div class="description">Subsystem minor version</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x50</div>
                        <div class="field-name">Win32VersionValue</div>
                        <div class="data-type">DWORD</div>
                        <div class="description">Reserved, must be zero</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x54</div>
                        <div class="field-name">SizeOfImage</div>
                        <div class="data-type">DWORD</div>
                        <div class="description">Size of image in memory</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x58</div>
                        <div class="field-name">SizeOfHeaders</div>
                        <div class="data-type">DWORD</div>
                        <div class="description">Size of headers</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x5C</div>
                        <div class="field-name">CheckSum</div>
                        <div class="data-type">DWORD</div>
                        <div class="description">Image checksum</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x60</div>
                        <div class="field-name">Subsystem</div>
                        <div class="data-type">WORD</div>
                        <div class="description">Subsystem required</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x62</div>
                        <div class="field-name">DllCharacteristics</div>
                        <div class="data-type">WORD</div>
                        <div class="description">DLL characteristics</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x64</div>
                        <div class="field-name">SizeOfStackReserve</div>
                        <div class="data-type">ULONGLONG</div>
                        <div class="description">Stack reserve size</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x6C</div>
                        <div class="field-name">SizeOfStackCommit</div>
                        <div class="data-type">ULONGLONG</div>
                        <div class="description">Stack commit size</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x74</div>
                        <div class="field-name">SizeOfHeapReserve</div>
                        <div class="data-type">ULONGLONG</div>
                        <div class="description">Heap reserve size</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x7C</div>
                        <div class="field-name">SizeOfHeapCommit</div>
                        <div class="data-type">ULONGLONG</div>
                        <div class="description">Heap commit size</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x84</div>
                        <div class="field-name">LoaderFlags</div>
                        <div class="data-type">DWORD</div>
                        <div class="description">Reserved, must be zero</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x88</div>
                        <div class="field-name">NumberOfRvaAndSizes</div>
                        <div class="data-type">DWORD</div>
                        <div class="description">Number of data directories</div>
                    </div>
                    
                    <div class="section-header">Data Directories (16 entries × 8 bytes each)</div>
                    <div class="field-row">
                        <div class="offset">+0x8C</div>
                        <div class="field-name">DataDirectory[16]</div>
                        <div class="data-type">IMAGE_DATA_DIRECTORY[16]</div>
                        <div class="description">Export, Import, Resource, Exception, Security, etc.</div>
                    </div>
                </div>
            </div>

            <!-- Section Table -->
            <div class="header-section">
                <div class="header-title">Section Table (IMAGE_SECTION_HEADER) - 40 bytes per section</div>
                <div class="header-content">
                    <div class="field-row">
                        <div class="offset">+0x00</div>
                        <div class="field-name">Name</div>
                        <div class="data-type">BYTE[8]</div>
                        <div class="description">Section name (null-terminated)</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x08</div>
                        <div class="field-name">VirtualSize</div>
                        <div class="data-type">DWORD</div>
                        <div class="description">Virtual size in memory</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x0C</div>
                        <div class="field-name">VirtualAddress</div>
                        <div class="data-type">DWORD</div>
                        <div class="description">Virtual address (RVA)</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x10</div>
                        <div class="field-name">SizeOfRawData</div>
                        <div class="data-type">DWORD</div>
                        <div class="description">Size of section in file</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x14</div>
                        <div class="field-name">PointerToRawData</div>
                        <div class="data-type">DWORD</div>
                        <div class="description">File pointer to section data</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x18</div>
                        <div class="field-name">PointerToRelocations</div>
                        <div class="data-type">DWORD</div>
                        <div class="description">File pointer to relocations</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x1C</div>
                        <div class="field-name">PointerToLinenumbers</div>
                        <div class="data-type">DWORD</div>
                        <div class="description">File pointer to line numbers</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x20</div>
                        <div class="field-name">NumberOfRelocations</div>
                        <div class="data-type">WORD</div>
                        <div class="description">Number of relocations</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x22</div>
                        <div class="field-name">NumberOfLinenumbers</div>
                        <div class="data-type">WORD</div>
                        <div class="description">Number of line numbers</div>
                    </div>
                    <div class="field-row">
                        <div class="offset">+0x24</div>
                        <div class="field-name">Characteristics</div>
                        <div class="data-type">DWORD</div>
                        <div class="description">Section characteristics flags</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="memory-layout">
            <h2 style="color: #00ff88; text-align: center; margin-bottom: 20px;">Physical Disk Layout</h2>
            <div style="text-align: center; margin-bottom: 15px; color: #ccc;">
                Each square represents 4 bytes | File starts at offset 0x00000000
            </div>
            
            <div class="byte-visualization" id="diskLayout">
                <!-- Bytes will be generated by JavaScript -->
            </div>
            
            <div style="text-align: center; margin-top: 20px; color: #ccc;">
                Hover over bytes to see their purpose in the PE structure
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div class="footer">
        <h3>🚀 Interactive PE File Structure Visualizer</h3>
        <p>A comprehensive, interactive visualization of the Portable Executable (PE) file format structure as stored on disk.</p>
        <p>This tool provides detailed explanations of every header field, data types, and memory layout to help developers, security researchers, and reverse engineers understand PE files at the binary level.</p>
        
        <div class="tech-stack">
            <div class="tech-item">HTML5</div>
            <div class="tech-item">CSS3 + Animations</div>
            <div class="tech-item">Vanilla JavaScript</div>
            <div class="tech-item">Interactive Tooltips</div>
            <div class="tech-item">Responsive Design</div>
        </div>
        
        <div class="author">
            Created with ❤️ by Claude (Anthropic's AI Assistant)
        </div>
        <p style="font-size: 0.9em; margin-top: 10px; opacity: 0.8;">
            Built to make PE format learning interactive and engaging • Hover over any field for detailed explanations • © 2025
        </p>
    </div>

    <!-- Tooltip for detailed explanations -->
    <div id="tooltip" class="tooltip">
        <div class="tooltip-title" id="tooltipTitle"></div>
        <div class="tooltip-content" id="tooltipContent"></div>
    </div>

    <script>
        // Detailed field explanations
        const fieldExplanations = {
            'e_magic': {
                title: 'DOS Header Magic Number (e_magic)',
                content: `This is the first field of every PE file and serves as the file signature. It identifies the file as a DOS executable format.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Value & Example:</div>
                    • Always contains 0x5A4D (ASCII "MZ")<br>
                    • Named after Mark Zbikowski, one of MS-DOS architects<br>
                    • Hex dump: 4D 5A (little-endian)<br>
                    • If this value is different, the file is not a valid PE
                </div>
                This field allows DOS to recognize the file as executable, even though modern PE files don't run under DOS.`
            },
            'e_cblp': {
                title: 'Bytes on Last Page (e_cblp)',
                content: `Specifies the number of bytes used in the last page of the DOS executable portion.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Technical Details:</div>
                    • DOS pages are 512 bytes<br>
                    • If 0, the last page uses all 512 bytes<br>
                    • Typical value: 0x0090 (144 bytes)<br>
                    • Modern PE files often set this to 0
                </div>
                This field is a legacy from DOS executables and is largely ignored by modern loaders.`
            },
            'e_cp': {
                title: 'Pages in File (e_cp)',
                content: `Number of 512-byte pages in the DOS executable portion of the file.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Calculation:</div>
                    • Total DOS size = (e_cp - 1) * 512 + e_cblp<br>
                    • Typical value: 0x0003 (3 pages)<br>
                    • Modern PE: Usually 3-4 pages for DOS stub
                </div>
                Used by DOS to determine how much memory to allocate for the executable.`
            },
            'e_crlc': {
                title: 'Relocations (e_crlc)',
                content: `Number of relocation entries in the DOS executable.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Purpose:</div>
                    • DOS relocations for segment addresses<br>
                    • Modern PE files: Usually 0<br>
                    • Location: After DOS header at e_lfarlc offset
                </div>
                Relocations allow DOS executables to be loaded at different memory addresses.`
            },
            'e_cparhdr': {
                title: 'Header Size in Paragraphs (e_cparhdr)',
                content: `Size of the DOS header in 16-byte paragraphs.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Calculation:</div>
                    • Paragraph = 16 bytes<br>
                    • Header size = e_cparhdr * 16<br>
                    • Typical value: 0x0004 (64 bytes)<br>
                    • Points to start of DOS executable code
                </div>
                This tells DOS where the actual executable code begins after the header.`
            },
            'e_minalloc': {
                title: 'Minimum Extra Paragraphs (e_minalloc)',
                content: `Minimum number of 16-byte paragraphs needed above the program.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Memory Management:</div>
                    • DOS memory allocation requirement<br>
                    • Modern PE: Usually 0<br>
                    • Used for stack and heap space<br>
                    • Prevents "Insufficient memory" errors
                </div>
                DOS uses this to ensure enough memory is available before loading the program.`
            },
            'e_maxalloc': {
                title: 'Maximum Extra Paragraphs (e_maxalloc)',
                content: `Maximum number of 16-byte paragraphs desired above the program.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Memory Preference:</div>
                    • 0xFFFF = allocate as much as possible<br>
                    • Modern PE: Usually 0xFFFF<br>
                    • DOS uses this for optimal performance<br>
                    • Larger = more memory for program use
                </div>
                This is the preferred amount of memory, not a requirement like e_minalloc.`
            },
            'e_ss': {
                title: 'Initial Stack Segment (e_ss)',
                content: `Initial relative stack segment address for DOS execution.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Stack Setup:</div>
                    • Relative to program load address<br>
                    • Modern PE: Usually 0<br>
                    • DOS: Points to stack segment<br>
                    • Combined with e_sp for full stack pointer
                </div>
                DOS uses this to set up the stack segment register when launching the program.`
            },
            'e_sp': {
                title: 'Initial Stack Pointer (e_sp)',
                content: `Initial stack pointer value for DOS execution.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Stack Initialization:</div>
                    • Offset within stack segment<br>
                    • Modern PE: Usually 0x00B8<br>
                    • DOS: Stack top position<br>
                    • Full address = e_ss:e_sp
                </div>
                This sets the initial position of the stack pointer when DOS runs the program.`
            },
            'e_csum': {
                title: 'Checksum (e_csum)',
                content: `File checksum for DOS executable portion (rarely used).
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Integrity Check:</div>
                    • Usually 0 (not calculated)<br>
                    • Simple sum of all words in file<br>
                    • Modern PE: Ignored<br>
                    • DOS: Optional verification
                </div>
                This was intended for file integrity verification but is rarely implemented.`
            },
            'e_ip': {
                title: 'Initial Instruction Pointer (e_ip)',
                content: `Initial instruction pointer (entry point) for DOS execution.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Entry Point:</div>
                    • Offset within code segment<br>
                    • Modern PE: Usually 0<br>
                    • DOS: First instruction to execute<br>
                    • Full address = e_cs:e_ip
                </div>
                This tells DOS where to start executing the program code.`
            },
            'e_cs': {
                title: 'Initial Code Segment (e_cs)',
                content: `Initial code segment address relative to program start.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Code Location:</div>
                    • Relative to program load address<br>
                    • Modern PE: Usually 0<br>
                    • DOS: Points to executable code<br>
                    • Combined with e_ip for entry point
                </div>
                DOS uses this to set the code segment register and jump to the program entry point.`
            },
            'e_lfarlc': {
                title: 'Relocation Table Address (e_lfarlc)',
                content: `File offset to the DOS relocation table.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Relocation Data:</div>
                    • Byte offset from file start<br>
                    • Modern PE: Usually 0x0040<br>
                    • Points to relocation entries<br>
                    • Number of entries = e_crlc
                </div>
                This points to the table containing addresses that need to be adjusted when loading.`
            },
            'e_ovno': {
                title: 'Overlay Number (e_ovno)',
                content: `Overlay number for DOS programs with overlays.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Overlay System:</div>
                    • 0 = main program (resident)<br>
                    • >0 = overlay number<br>
                    • Modern PE: Always 0<br>
                    • DOS: Memory management technique
                </div>
                Overlays allowed DOS programs to be larger than available memory by swapping code segments.`
            },
            'e_res': {
                title: 'Reserved Words (e_res)',
                content: `Array of 4 reserved words for future DOS extensions.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Reserved Space:</div>
                    • 4 × 16-bit words = 8 bytes<br>
                    • Always zero in PE files<br>
                    • Originally for DOS expansion<br>
                    • Modern: Padding/alignment
                </div>
                These were reserved for future DOS features but are now just padding in PE files.`
            },
            'e_oemid': {
                title: 'OEM Identifier (e_oemid)',
                content: `OEM identifier for OEM-specific information.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">OEM Usage:</div>
                    • Original Equipment Manufacturer ID<br>
                    • Modern PE: Usually 0<br>
                    • DOS: Hardware-specific code<br>
                    • Used with e_oeminfo
                </div>
                This allowed DOS programs to identify specific hardware or OEM configurations.`
            },
            'e_oeminfo': {
                title: 'OEM Information (e_oeminfo)',
                content: `OEM-specific information, used with e_oemid.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">OEM Data:</div>
                    • Meaning depends on e_oemid<br>
                    • Modern PE: Usually 0<br>
                    • DOS: Hardware configuration<br>
                    • Custom OEM extensions
                </div>
                This provided additional OEM-specific data for specialized DOS environments.`
            },
            'e_res2': {
                title: 'Reserved Words 2 (e_res2)',
                content: `Array of 10 reserved words, more space for DOS extensions.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Extended Reserved:</div>
                    • 10 × 16-bit words = 20 bytes<br>
                    • Always zero in PE files<br>
                    • DOS: Future expansion space<br>
                    • Modern: Padding before e_lfanew
                </div>
                Additional reserved space that was never used by DOS but provides padding in PE files.`
            },
            'e_lfanew': {
                title: 'New EXE Header Offset (e_lfanew)',
                content: `File offset to the PE header - the most important DOS header field for PE files!
                <div class="tooltip-example">
                    <div class="tooltip-example-title">PE Header Location:</div>
                    • 32-bit file offset<br>
                    • Typical value: 0x000000F0 (240 bytes)<br>
                    • Points to "PE\\0\\0" signature<br>
                    • Essential for PE file parsing
                </div>
                This is the bridge between the DOS stub and the actual PE format. The PE loader uses this to skip the DOS portion and jump directly to the PE headers.`
            },
            'Signature': {
                title: 'PE Signature',
                content: `The PE file format signature that identifies this as a valid PE file.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Signature Details:</div>
                    • Value: 0x00004550 ("PE\\0\\0")<br>
                    • ASCII: P(0x50) E(0x45) \\0(0x00) \\0(0x00)<br>
                    • Located at offset e_lfanew<br>
                    • Must be present for valid PE
                </div>
                The Windows PE loader checks this signature to confirm the file is a valid PE executable before parsing the rest of the headers.`
            },
            'Machine': {
                title: 'Machine Type (Machine)',
                content: `Specifies the target CPU architecture for this PE file.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Common Values:</div>
                    • 0x014c = IMAGE_FILE_MACHINE_I386 (x86)<br>
                    • 0x0200 = IMAGE_FILE_MACHINE_IA64 (Itanium)<br>
                    • 0x8664 = IMAGE_FILE_MACHINE_AMD64 (x64)<br>
                    • 0x01c0 = IMAGE_FILE_MACHINE_ARM<br>
                    • 0xaa64 = IMAGE_FILE_MACHINE_ARM64
                </div>
                The OS loader uses this to ensure the PE file is compatible with the current processor architecture.`
            },
            'NumberOfSections': {
                title: 'Number of Sections (NumberOfSections)',
                content: `Count of sections in the PE file's section table.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Section Information:</div>
                    • Typical range: 3-8 sections<br>
                    • Common sections: .text, .data, .rsrc<br>
                    • Each section = 40 bytes in section table<br>
                    • Maximum: 96 sections (practical limit)
                </div>
                This tells the PE loader how many section headers to read from the section table that follows the optional header.`
            },
            'TimeDateStamp': {
                title: 'Time Date Stamp (TimeDateStamp)',
                content: `Unix timestamp indicating when the PE file was created/linked.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Timestamp Format:</div>
                    • Seconds since January 1, 1970 UTC<br>
                    • Example: 0x5E7B8A1C = March 25, 2020<br>
                    • Set by linker during compilation<br>
                    • Used for version tracking and debugging
                </div>
                This timestamp helps identify when the executable was built and can be used for forensic analysis or version tracking.`
            },
            'PointerToSymbolTable': {
                title: 'Symbol Table Pointer (PointerToSymbolTable)',
                content: `File offset to the COFF symbol table (usually 0 in PE files).
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Symbol Table Info:</div>
                    • Usually 0 in release builds<br>
                    • Debug builds may have symbols<br>
                    • COFF format symbol table<br>
                    • Used with NumberOfSymbols
                </div>
                Modern PE files typically store debug information in separate PDB files, so this is usually zero.`
            },
            'NumberOfSymbols': {
                title: 'Number of Symbols (NumberOfSymbols)',
                content: `Count of entries in the COFF symbol table.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Symbol Count:</div>
                    • Usually 0 in release builds<br>
                    • Each symbol = 18 bytes<br>
                    • Contains function/variable names<br>
                    • Used for debugging and linking
                </div>
                This field is typically zero in modern PE files since debug symbols are usually stored externally.`
            },
            'SizeOfOptionalHeader': {
                title: 'Optional Header Size (SizeOfOptionalHeader)',
                content: `Size of the optional header that follows the file header.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Header Sizes:</div>
                    • PE32: 224 bytes (0x00E0)<br>
                    • PE32+: 240 bytes (0x00F0)<br>
                    • Includes data directories<br>
                    • Must be present for PE files
                </div>
                Despite its name, the "optional" header is required for PE executables and contains crucial loading information.`
            },
            'Characteristics': {
                title: 'File Characteristics (Characteristics)',
                content: `Bit flags that describe the properties and capabilities of the PE file.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Common Flags:</div>
                    • 0x0002 = IMAGE_FILE_EXECUTABLE_IMAGE<br>
                    • 0x0020 = IMAGE_FILE_LARGE_ADDRESS_AWARE<br>
                    • 0x0100 = IMAGE_FILE_32BIT_MACHINE<br>
                    • 0x2000 = IMAGE_FILE_DLL<br>
                    • 0x8000 = IMAGE_FILE_BYTES_REVERSED_HI
                </div>
                These flags tell the OS loader important properties about the file, such as whether it's executable, a DLL, or supports large addresses.`
            },
            'Magic': {
                title: 'Optional Header Magic (Magic)',
                content: `Identifies the type of optional header and PE format version.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Magic Values:</div>
                    • 0x010B = PE32 (32-bit executable)<br>
                    • 0x020B = PE32+ (64-bit executable)<br>
                    • 0x0107 = ROM image<br>
                    • Determines optional header size
                </div>
                This field tells the PE loader which format to expect and how to interpret the rest of the optional header.`
            },
            'MajorLinkerVersion': {
                title: 'Major Linker Version (MajorLinkerVersion)',
                content: `Major version number of the linker that created this PE file.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Version Examples:</div>
                    • Visual Studio 2019: 14<br>
                    • Visual Studio 2017: 14<br>
                    • Visual Studio 2015: 14<br>
                    • Used for toolchain identification
                </div>
                This helps identify which development tools were used to create the executable.`
            },
            'MinorLinkerVersion': {
                title: 'Minor Linker Version (MinorLinkerVersion)',
                content: `Minor version number of the linker that created this PE file.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Detailed Versioning:</div>
                    • Combined with major version<br>
                    • Example: 14.29 (VS 2019 v16.11)<br>
                    • Helps track specific toolchain updates<br>
                    • Useful for debugging compatibility issues
                </div>
                This provides more granular version information about the linking tools used.`
            },
            'SizeOfCode': {
                title: 'Size of Code (SizeOfCode)',
                content: `Total size of all executable code sections in the PE file.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Code Calculation:</div>
                    • Sum of all sections with IMAGE_SCN_CNT_CODE<br>
                    • Usually .text section size<br>
                    • Rounded up to file alignment<br>
                    • Example: 0x00001000 (4096 bytes)
                </div>
                This tells the loader how much memory is needed for executable code sections.`
            },
            'SizeOfInitializedData': {
                title: 'Size of Initialized Data (SizeOfInitializedData)',
                content: `Total size of all sections containing initialized data.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Data Sections:</div>
                    • .data section (global variables)<br>
                    • .rdata section (read-only data)<br>
                    • .rsrc section (resources)<br>
                    • Rounded to file alignment
                </div>
                This includes all sections that contain pre-initialized data that must be loaded into memory.`
            },
            'SizeOfUninitializedData': {
                title: 'Size of Uninitialized Data (SizeOfUninitializedData)',
                content: `Total size of sections containing uninitialized data (BSS).
                <div class="tooltip-example">
                    <div class="tooltip-example-title">BSS Section:</div>
                    • .bss section (zero-initialized variables)<br>
                    • Not stored in file (saves space)<br>
                    • Loader zeros this memory<br>
                    • Often 0 in modern PE files
                </div>
                This represents memory that needs to be allocated and zero-initialized at load time.`
            },
            'AddressOfEntryPoint': {
                title: 'Entry Point Address (AddressOfEntryPoint)',
                content: `Relative Virtual Address (RVA) of the program's entry point.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Entry Point Details:</div>
                    • RVA from ImageBase<br>
                    • Usually in .text section<br>
                    • Example: 0x00001000<br>
                    • 0 for DLLs without entry point
                </div>
                This is where execution begins when the program is loaded. For DLLs, this is the DllMain function.`
            },
            'BaseOfCode': {
                title: 'Base of Code (BaseOfCode)',
                content: `RVA of the first byte of code when loaded into memory.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Code Base:</div>
                    • Usually 0x00001000<br>
                    • Beginning of .text section<br>
                    • Relative to ImageBase<br>
                    • Used for code section alignment
                </div>
                This indicates where the executable code section begins in the virtual address space.`
            },
            'BaseOfData': {
                title: 'Base of Data (BaseOfData)',
                content: `RVA of the first byte of data when loaded into memory (PE32 only).
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Data Base (PE32):</div>
                    • Only present in PE32, not PE32+<br>
                    • Usually follows code section<br>
                    • Example: 0x00003000<br>
                    • Beginning of .data section
                </div>
                This field is removed in PE32+ format as 64-bit addressing makes it unnecessary.`
            },
            'ImageBase': {
                title: 'Image Base Address (ImageBase)',
                content: `Preferred virtual address where the PE file should be loaded.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Base Addresses:</div>
                    • EXE: 0x00400000 (PE32) or 0x0000000140000000 (PE32+)<br>
                    • DLL: 0x10000000 (PE32) or 0x0000000180000000 (PE32+)<br>
                    • ASLR may override this<br>
                    • Affects RVA calculations
                </div>
                If this address is available, the loader can avoid relocations. Otherwise, the image is relocated and fixups are applied.`
            },
            'SectionAlignment': {
                title: 'Section Alignment (SectionAlignment)',
                content: `Alignment of sections when loaded into memory.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Memory Alignment:</div>
                    • Usually 0x1000 (4096 bytes)<br>
                    • Must be ≥ page size<br>
                    • Power of 2 value<br>
                    • Ensures proper memory protection
                </div>
                This ensures sections are aligned on memory page boundaries for proper virtual memory management.`
            },
            'FileAlignment': {
                title: 'File Alignment (FileAlignment)',
                content: `Alignment of section data in the PE file on disk.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">File Alignment:</div>
                    • Usually 0x200 (512 bytes)<br>
                    • Must be power of 2<br>
                    • Range: 512 to 64K<br>
                    • Optimizes disk I/O
                </div>
                This alignment reduces file size while maintaining compatibility with file system cluster sizes.`
            },
            'MajorOperatingSystemVersion': {
                title: 'Major OS Version (MajorOperatingSystemVersion)',
                content: `Minimum major version of the operating system required.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">OS Versions:</div>
                    • Windows 10/11: 10<br>
                    • Windows 8.1: 6<br>
                    • Windows 7: 6<br>
                    • Usually set by linker
                </div>
                This field helps ensure compatibility with the target operating system version.`
            },
            'MinorOperatingSystemVersion': {
                title: 'Minor OS Version (MinorOperatingSystemVersion)',
                content: `Minimum minor version of the operating system required.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Minor Versions:</div>
                    • Windows 11: 0<br>
                    • Windows 10: 0<br>
                    • Windows 8.1: 3<br>
                    • Combined with major version
                </div>
                This provides more specific OS version requirements for the executable.`
            },
            'MajorImageVersion': {
                title: 'Major Image Version (MajorImageVersion)',
                content: `Major version number of the application or image.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Image Versioning:</div>
                    • User-defined version number<br>
                    • Part of application versioning<br>
                    • Often matches file version<br>
                    • Example: 1 for version 1.0
                </div>
                This is typically set by the developer to indicate the application's major version.`
            },
            'MinorImageVersion': {
                title: 'Minor Image Version (MinorImageVersion)',
                content: `Minor version number of the application or image.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Version Details:</div>
                    • User-defined minor version<br>
                    • Combined with major version<br>
                    • Example: 5 for version 1.5<br>
                    • Used for compatibility checks
                </div>
                This complements the major version to provide detailed application versioning information.`
            },
            'MajorSubsystemVersion': {
                title: 'Major Subsystem Version (MajorSubsystemVersion)',
                content: `Minimum major version of the subsystem required to run the image.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Subsystem Versions:</div>
                    • Windows GUI: 6.0+<br>
                    • Console: 6.0+<br>
                    • Must match OS capabilities<br>
                    • Affects API availability
                </div>
                This ensures the executable only runs on systems that support the required subsystem version.`
            },
            'MinorSubsystemVersion': {
                title: 'Minor Subsystem Version (MinorSubsystemVersion)',
                content: `Minimum minor version of the subsystem required to run the image.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Precise Requirements:</div>
                    • Fine-grained subsystem requirements<br>
                    • Example: 6.1 for Windows 7 features<br>
                    • Loader validates compatibility<br>
                    • Prevents unsupported API usage
                </div>
                This provides specific subsystem version requirements for proper execution.`
            },
            'Win32VersionValue': {
                title: 'Win32 Version Value (Win32VersionValue)',
                content: `Reserved field that must be set to zero.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Reserved Field:</div>
                    • Always 0x00000000<br>
                    • Originally intended for future use<br>
                    • Never implemented<br>
                    • Loader ignores this field
                </div>
                This field was reserved for future Windows versions but was never used and must remain zero.`
            },
            'SizeOfImage': {
                title: 'Size of Image (SizeOfImage)',
                content: `Total size of the PE image when loaded into memory.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Memory Footprint:</div>
                    • Includes all sections and headers<br>
                    • Rounded to SectionAlignment<br>
                    • Used for memory allocation<br>
                    • Example: 0x00005000 (20KB)
                </div>
                The loader uses this to allocate the correct amount of virtual memory for the entire image.`
            },
            'SizeOfHeaders': {
                title: 'Size of Headers (SizeOfHeaders)',
                content: `Total size of all headers and section table, rounded to FileAlignment.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Header Size:</div>
                    • DOS header + PE headers + section table<br>
                    • Rounded to FileAlignment boundary<br>
                    • Where first section data begins<br>
                    • Example: 0x00000400 (1024 bytes)
                </div>
                This tells the loader where the actual section data begins in the file.`
            },
            'CheckSum': {
                title: 'Image Checksum (CheckSum)',
                content: `Checksum of the entire PE file for integrity verification.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Checksum Usage:</div>
                    • Required for kernel drivers<br>
                    • Optional for user applications<br>
                    • Calculated by MapFileAndCheckSum API<br>
                    • 0 means no checksum validation
                </div>
                Critical system files like drivers must have valid checksums, while regular applications often have this set to 0.`
            },
            'Subsystem': {
                title: 'Subsystem (Subsystem)',
                content: `Specifies the Windows subsystem required to run the image.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Subsystem Types:</div>
                    • 1 = IMAGE_SUBSYSTEM_NATIVE (drivers)<br>
                    • 2 = IMAGE_SUBSYSTEM_WINDOWS_GUI<br>
                    • 3 = IMAGE_SUBSYSTEM_WINDOWS_CUI (console)<br>
                    • 9 = IMAGE_SUBSYSTEM_WINDOWS_CE_GUI
                </div>
                This determines how Windows will run the executable and what type of user interface it expects.`
            },
            'DllCharacteristics': {
                title: 'DLL Characteristics (DllCharacteristics)',
                content: `Bit flags specifying DLL characteristics and security features.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Security Flags:</div>
                    • 0x0020 = HIGH_ENTROPY_VA (64-bit ASLR)<br>
                    • 0x0040 = DYNAMIC_BASE (ASLR enabled)<br>
                    • 0x0080 = FORCE_INTEGRITY (signature required)<br>
                    • 0x0100 = NX_COMPAT (DEP enabled)<br>
                    • 0x8000 = TERMINAL_SERVER_AWARE
                </div>
                These flags enable modern security features like ASLR, DEP, and code integrity checks.`
            },
            'SizeOfStackReserve': {
                title: 'Stack Reserve Size (SizeOfStackReserve)',
                content: `Amount of virtual memory to reserve for the stack.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Stack Memory:</div>
                    • Default: 1MB (0x100000)<br>
                    • Total stack space available<br>
                    • Only reserve, not commit<br>
                    • Can be overridden by linker
                </div>
                This sets the maximum stack size that can be committed later as needed during execution.`
            },
            'SizeOfStackCommit': {
                title: 'Stack Commit Size (SizeOfStackCommit)',
                content: `Amount of stack memory to commit initially.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Initial Stack:</div>
                    • Default: 4KB (0x1000)<br>
                    • Actually allocated at startup<br>
                    • Additional pages committed as needed<br>
                    • Must be ≤ SizeOfStackReserve
                </div>
                This is the amount of stack memory that is immediately available when the process starts.`
            },
            'SizeOfHeapReserve': {
                title: 'Heap Reserve Size (SizeOfHeapReserve)',
                content: `Amount of virtual memory to reserve for the default heap.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Heap Memory:</div>
                    • Default: 1MB (0x100000)<br>
                    • Process default heap size<br>
                    • Additional heaps can be created<br>
                    • Used by malloc/new
                </div>
                This sets the maximum size for the process's default heap used for dynamic memory allocation.`
            },
            'SizeOfHeapCommit': {
                title: 'Heap Commit Size (SizeOfHeapCommit)',
                content: `Amount of heap memory to commit initially.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Initial Heap:</div>
                    • Default: 4KB (0x1000)<br>
                    • Initially committed heap space<br>
                    • Grows automatically as needed<br>
                    • Must be ≤ SizeOfHeapReserve
                </div>
                This is the amount of heap memory immediately available for dynamic allocation at process startup.`
            },
            'LoaderFlags': {
                title: 'Loader Flags (LoaderFlags)',
                content: `Reserved field for loader flags, must be zero.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Obsolete Field:</div>
                    • Always 0x00000000<br>
                    • Originally for debugging support<br>
                    • No longer used by Windows<br>
                    • Loader ignores this field
                </div>
                This field was used in older versions of Windows but is now obsolete and must be zero.`
            },
            'NumberOfRvaAndSizes': {
                title: 'Number of Data Directories (NumberOfRvaAndSizes)',
                content: `Number of entries in the data directory array that follows.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Directory Count:</div>
                    • Usually 16 (0x00000010)<br>
                    • Each entry is 8 bytes<br>
                    • Points to Import, Export, Resource tables<br>
                    • Can be less than 16 for minimal PEs
                </div>
                This specifies how many data directory entries are present, defining the locations of important PE structures.`
            },
            'DataDirectory': {
                title: 'Data Directory Array (DataDirectory)',
                content: `Array of IMAGE_DATA_DIRECTORY structures pointing to important PE data.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Directory Entries:</div>
                    • [0] Export Table<br>
                    • [1] Import Table<br>
                    • [2] Resource Table<br>
                    • [3] Exception Table<br>
                    • [5] Base Relocation Table<br>
                    • [14] CLR Runtime Header (.NET)
                </div>
                Each entry contains an RVA and size pointing to critical PE structures like imports, exports, and resources.`
            },
            'Name': {
                title: 'Section Name (Name)',
                content: `8-byte ASCII name of the section, null-terminated if less than 8 characters.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Common Names:</div>
                    • ".text" - executable code<br>
                    • ".data" - initialized data<br>
                    • ".rdata" - read-only data<br>
                    • ".rsrc" - resources<br>
                    • ".reloc" - base relocations
                </div>
                Section names starting with '.' are conventional but not required. The name helps identify the section's purpose.`
            },
            'VirtualSize': {
                title: 'Virtual Size (VirtualSize)',
                content: `Size of the section when loaded into memory, before alignment.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Memory Size:</div>
                    • Actual data size in memory<br>
                    • May be larger than SizeOfRawData<br>
                    • Excess is zero-filled<br>
                    • Used for .bss-like sections
                </div>
                This is the actual size of the section data in memory, which may differ from the file size due to alignment and zero-padding.`
            },
            'VirtualAddress': {
                title: 'Virtual Address (VirtualAddress)',
                content: `RVA where the section will be loaded in memory.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Memory Location:</div>
                    • Relative to ImageBase<br>
                    • Aligned to SectionAlignment<br>
                    • Example: 0x00001000<br>
                    • Determines section memory layout
                </div>
                This specifies where in the process's virtual address space this section will be mapped.`
            },
            'SizeOfRawData': {
                title: 'Size of Raw Data (SizeOfRawData)',
                content: `Size of the section data in the PE file on disk.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">File Size:</div>
                    • Rounded to FileAlignment<br>
                    • May be smaller than VirtualSize<br>
                    • 0 for uninitialized sections<br>
                    • Used for file I/O operations
                </div>
                This is the actual amount of data stored in the file for this section, which may be smaller than the memory size.`
            },
            'PointerToRelocations': {
                title: 'Relocations Pointer (PointerToRelocations)',
                content: `File offset to relocation entries for this section (usually 0 in PE files).
                <div class="tooltip-example">
                    <div class="tooltip-example-title">COFF Relocations:</div>
                    • Usually 0 in executable PE files<br>
                    • Used in object files (.obj)<br>
                    • Each relocation = 10 bytes<br>
                    • Modern PEs use base relocations instead
                </div>
                This field is a remnant from COFF object files and is typically zero in final PE executables.`
            },
            'PointerToLinenumbers': {
                title: 'Line Numbers Pointer (PointerToLinenumbers)',
                content: `File offset to COFF line number entries (deprecated, usually 0).
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Debug Information:</div>
                    • Deprecated in favor of PDB files<br>
                    • Usually 0 in modern PE files<br>
                    • Used for source-level debugging<br>
                    • Each entry = 6 bytes
                </div>
                This field provided source code line number information but has been replaced by modern debug formats.`
            },
            'NumberOfRelocations': {
                title: 'Number of Relocations (NumberOfRelocations)',
                content: `Count of relocation entries for this section.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Relocation Count:</div>
                    • Usually 0 in PE executables<br>
                    • Used in COFF object files<br>
                    • Maximum: 65535 entries<br>
                    • Extended format available for more
                </div>
                This specifies how many relocation entries exist for this section in COFF object files.`
            },
            'NumberOfLinenumbers': {
                title: 'Number of Line Numbers (NumberOfLinenumbers)',
                content: `Count of line number entries for this section (deprecated).
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Debug Line Count:</div>
                    • Usually 0 in modern PE files<br>
                    • Deprecated debugging feature<br>
                    • Replaced by PDB debug info<br>
                    • Each entry maps code to source lines
                </div>
                This field counted source code line number entries but is no longer used in modern development.`
            },
            'Characteristics': {
                title: 'Section Characteristics (Characteristics)',
                content: `Bit flags describing the section's properties and permissions.
                <div class="tooltip-example">
                    <div class="tooltip-example-title">Common Flags:</div>
                    • 0x00000020 = IMAGE_SCN_CNT_CODE (executable)<br>
                    • 0x00000040 = IMAGE_SCN_CNT_INITIALIZED_DATA<br>
                    • 0x00000080 = IMAGE_SCN_CNT_UNINITIALIZED_DATA<br>
                    • 0x20000000 = IMAGE_SCN_MEM_EXECUTE<br>
                    • 0x40000000 = IMAGE_SCN_MEM_READ<br>
                    • 0x80000000 = IMAGE_SCN_MEM_WRITE
                </div>
                These flags determine how the section can be used: whether it's executable, readable, writable, and what type of content it contains.`
            }
        };

        // Create and manage tooltip
        function createTooltip() {
            const tooltip = document.getElementById('tooltip');
            const tooltipTitle = document.getElementById('tooltipTitle');
            const tooltipContent = document.getElementById('tooltipContent');

            // Add hover listeners to all field names
            const fieldNames = document.querySelectorAll('.field-name');
            fieldNames.forEach(field => {
                field.addEventListener('mouseenter', function(e) {
                    const fieldName = this.textContent.trim();
                    const explanation = fieldExplanations[fieldName];
                    
                    if (explanation) {
                        tooltipTitle.textContent = explanation.title;
                        tooltipContent.innerHTML = explanation.content;
                        
                        // Position tooltip
                        const rect = this.getBoundingClientRect();
                        const tooltipRect = tooltip.getBoundingClientRect();
                        
                        let left = rect.right + 20;
                        let top = rect.top;
                        
                        // Adjust if tooltip would go off screen
                        if (left + 400 > window.innerWidth) {
                            left = rect.left - 420;
                        }
                        
                        if (top + 200 > window.innerHeight) {
                            top = window.innerHeight - 220;
                        }
                        
                        tooltip.style.left = left + 'px';
                        tooltip.style.top = top + 'px';
                        tooltip.classList.add('visible');
                    }
                });
                
                field.addEventListener('mouseleave', function() {
                    const tooltip = document.getElementById('tooltip');
                    tooltip.classList.remove('visible');
                });
            });
        }
        // Generate the disk layout visualization
        function generateDiskLayout() {
            const layout = document.getElementById('diskLayout');
            const totalBytes = 512; // Show first 512 bytes (128 * 4-byte chunks)
            
            // Define the structure boundaries
            const structures = [
                { start: 0, end: 64, class: 'dos-header', name: 'DOS Header' },
                { start: 64, end: 128, class: 'dos-header', name: 'DOS Stub' },
                { start: 128, end: 132, class: 'pe-header', name: 'PE Signature' },
                { start: 132, end: 152, class: 'pe-header', name: 'File Header' },
                { start: 152, end: 376, class: 'optional-header', name: 'Optional Header' },
                { start: 376, end: 456, class: 'section-table', name: 'Section Table Entry 1' },
                { start: 456, end: 496, class: 'section-table', name: 'Section Table Entry 2' },
                { start: 496, end: 512, class: 'section-table', name: 'Section Table Entry 3' }
            ];
            
            for (let i = 0; i < totalBytes / 4; i++) {
                const byteOffset = i * 4;
                const byte = document.createElement('div');
                byte.className = 'byte';
                
                // Find which structure this byte belongs to
                const structure = structures.find(s => byteOffset >= s.start && byteOffset < s.end);
                if (structure) {
                    byte.classList.add(structure.class);
                    byte.title = `Offset: 0x${byteOffset.toString(16).padStart(4, '0').toUpperCase()} - ${structure.name}`;
                } else {
                    byte.title = `Offset: 0x${byteOffset.toString(16).padStart(4, '0').toUpperCase()}`;
                }
                
                // Show the hex offset in the byte
                byte.textContent = byteOffset.toString(16).padStart(2, '0').toUpperCase().slice(-2);
                
                layout.appendChild(byte);
            }
        }
        
        // Add interactive hover effects
        function addInteractivity() {
            const bytes = document.querySelectorAll('.byte');
            bytes.forEach(byte => {
                byte.addEventListener('mouseenter', function() {
                    this.style.transform = 'scale(1.2)';
                    this.style.zIndex = '10';
                    this.style.boxShadow = '0 0 10px rgba(255, 255, 255, 0.5)';
                });
                
                byte.addEventListener('mouseleave', function() {
                    this.style.transform = 'scale(1)';
                    this.style.zIndex = '1';
                    this.style.boxShadow = 'none';
                });
            });
        }
        
        // Add section highlighting
        function addSectionHighlighting() {
            const sections = document.querySelectorAll('.header-section');
            sections.forEach(section => {
                section.addEventListener('mouseenter', function() {
                    const title = this.querySelector('.header-title').textContent;
                    let targetClass = '';
                    
                    if (title.includes('DOS Header')) {
                        targetClass = 'dos-header';
                    } else if (title.includes('PE Header')) {
                        targetClass = 'pe-header';
                    } else if (title.includes('Optional Header')) {
                        targetClass = 'optional-header';
                    } else if (title.includes('Section Table')) {
                        targetClass = 'section-table';
                    }
                    
                    if (targetClass) {
                        document.querySelectorAll(`.${targetClass}`).forEach(byte => {
                            byte.style.boxShadow = '0 0 15px rgba(255, 255, 255, 0.8)';
                            byte.style.transform = 'scale(1.1)';
                        });
                    }
                });
                
                section.addEventListener('mouseleave', function() {
                    document.querySelectorAll('.byte').forEach(byte => {
                        byte.style.boxShadow = 'none';
                        byte.style.transform = 'scale(1)';
                    });
                });
            });
        }
        
        // Add data type information popup
        function addDataTypeInfo() {
            const dataTypes = document.querySelectorAll('.data-type');
            dataTypes.forEach(type => {
                type.addEventListener('mouseenter', function() {
                    const typeText = this.textContent;
                    let info = '';
                    
                    switch(typeText) {
                        case 'WORD':
                            info = '16-bit unsigned integer (2 bytes)';
                            break;
                        case 'DWORD':
                            info = '32-bit unsigned integer (4 bytes)';
                            break;
                        case 'LONG':
                            info = '32-bit signed integer (4 bytes)';
                            break;
                        case 'ULONGLONG':
                            info = '64-bit unsigned integer (8 bytes)';
                            break;
                        case 'BYTE':
                            info = '8-bit unsigned integer (1 byte)';
                            break;
                        default:
                            info = 'Data type information';
                    }
                    
                    this.title = info;
                });
            });
        }
        
        // Initialize everything when the page loads
        document.addEventListener('DOMContentLoaded', function() {
            generateDiskLayout();
            addInteractivity();
            addSectionHighlighting();
            addDataTypeInfo();
            createTooltip();
        });
        
        // Add smooth scrolling animation
        function smoothScroll() {
            const headers = document.querySelectorAll('.header-section');
            
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                    }
                });
            }, {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            });
            
            headers.forEach(header => {
                header.style.opacity = '0';
                header.style.transform = 'translateY(30px)';
                header.style.transition = 'all 0.6s ease-out';
                observer.observe(header);
            });
        }
        
        // Initialize smooth scrolling
        document.addEventListener('DOMContentLoaded', smoothScroll);
    </script>
</body>
</html>